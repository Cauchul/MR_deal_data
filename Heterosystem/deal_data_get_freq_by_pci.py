# -*- coding: utf-8 -*-
# 异系统数据，根据pci获取freq值，并回插到csv结果文件中

import pandas as pd

from Common import df_write_to_csv, print_with_line_number

# get_list = ['PRACH配置索引', '下行频点']
# data_file = r'D:\MrData\国际财经中心周围1.5Km站点.xlsx'
# data = pd.read_excel(data_file, usecols=get_list)
# pci_to_freq_dict = data.set_index('PRACH配置索引')['下行频点'].to_dict()

pci_to_freq_dict = {9: 154600, 16: 154600, 64: 509004, 564: 509004, 596: 509004, 210: 513000, 83: 513000, 237: 513000,
                    490: 154600, 351: 513000, 350: 154600, 249: 513000, 14: 513000, 67: 509004, 66: 513000, 38: 154600,
                    352: 513000, 495: 513000, 454: 154600, 77: 154600, 120: 513000, 5: 513000, 48: 513000, 100: 513000,
                    217: 513000, 271: 513000, 3: 513000, 134: 513000, 366: 509004, 601: 509004, 26: 509004, 369: 154600,
                    410: 513000, 412: 154600, 186: 154600, 112: 154600, 335: 154600, 282: 513000, 278: 513000,
                    400: 154600, 373: 509004, 305: 154600, 42: 509004, 642: 513000, 124: 513000, 503: 513000,
                    541: 509004, 398: 509004, 414: 509004, 6: 509004, 368: 509004, 319: 509004, 301: 723334,
                    279: 723334, 575: 154600, 500: 154600, 492: 154600, 37: 154600, 30: 154600, 593: 513000,
                    292: 154600, 468: 723334, 494: 723334, 226: 723334, 371: 509004, 132: 509004, 643: 509004,
                    536: 513000, 273: 513000, 280: 513000, 264: 513000, 257: 513000, 568: 154600, 183: 509004,
                    520: 509004, 32: 509004, 218: 513000, 394: 513000, 381: 513000, 326: 513000, 202: 154600,
                    258: 154600, 230: 154600, 240: 154600, 406: 513000, 126: 723334, 391: 513000, 86: 154600,
                    184: 509004, 173: 509004, 72: 509004, 585: 723334, 589: 723334, 584: 723334, 140: 509004,
                    75: 509004, 145: 509004, 488: 513000, 445: 513000, 405: 513000, 634: 513000, 312: 513000,
                    629: 513000, 415: 513000, 450: 723334, 149: 723334, 283: 723334, 591: 723334, 296: 723334,
                    52: 513000, 458: 513000, 93: 513000, 199: 154600, 252: 154600, 125: 154600, 367: 513000, 8: 513000,
                    21: 513000, 447: 154600, 491: 509004, 241: 154600, 610: 154600, 603: 513000, 731: 154600,
                    58: 513000, 99: 513000, 50: 513000, 588: 509004, 160: 509004, 590: 509004, 683: 513000, 285: 723334,
                    362: 723334, 592: 723334, 306: 509004, 605: 509004, 505: 509004, 576: 509004, 572: 509004,
                    31: 509004, 288: 154600, 56: 509004, 269: 513000, 388: 513000, 87: 513000, 599: 513000, 399: 154600,
                    586: 513000, 81: 513000, 284: 513000, 46: 513000, 521: 154600, 420: 154600, 142: 154600,
                    315: 513000, 287: 513000, 85: 154600, 608: 513000, 250: 513000, 57: 513000, 243: 154600,
                    598: 513000, 215: 513000, 419: 509004, 384: 509004, 740: 154600, 611: 513000, 426: 513000,
                    529: 513000, 293: 154600, 204: 723334, 118: 723334, 191: 154600, 7: 513000, 318: 513000,
                    553: 509004, 44: 509004, 441: 509004, 73: 513000, 107: 513000, 177: 513000, 47: 513000, 94: 513000,
                    108: 513000, 130: 513000, 246: 513000, 276: 513000, 401: 513000, 616: 513000, 80: 513000,
                    154: 513000, 207: 513000, 261: 513000, 10: 513000, 41: 513000, 18: 513000, 338: 154600, 511: 154600,
                    153: 513000, 334: 513000, 128: 723334, 289: 513000, 648: 513000, 263: 513000, 137: 513000,
                    55: 154600, 165: 513000, 182: 154600, 40: 513000, 122: 513000, 510: 513000, 105: 154600,
                    178: 513000, 197: 513000, 213: 513000, 198: 154600, 451: 513000, 82: 513000, 515: 154600,
                    624: 513000, 449: 154600, 562: 513000, 417: 513000, 395: 513000, 349: 513000, 659: 513000,
                    155: 154600, 219: 513000, 166: 154600, 602: 513000, 485: 154600, 341: 513000, 232: 513000,
                    453: 513000, 205: 513000, 209: 513000, 225: 513000, 472: 513000, 512: 513000, 464: 154600,
                    148: 513000, 558: 513000, 507: 723334, 158: 513000, 211: 513000, 777: 513000, 762: 154600,
                    655: 513000, 666: 513000, 669: 513000, 670: 513000, 671: 154600, 672: 513000, 770: 513000,
                    772: 513000, 277: 513000, 612: 513000, 542: 154600, 799: 513000, 800: 513000, 443: 513000,
                    111: 513000, 51: 509004, 551: 509004, 481: 509004, 193: 154600, 614: 509004, 615: 509004,
                    753: 513000, 754: 513000, 700: 513000, 701: 513000, 702: 513000, 703: 154600, 704: 154600,
                    706: 154600, 452: 513000, 370: 513000, 300: 154600, 53: 513000, 181: 513000, 231: 154600,
                    674: 154600, 687: 513000, 688: 513000, 689: 513000, 677: 513000, 685: 513000, 686: 154600,
                    60: 154600, 62: 154600, 223: 513000, 720: 154600, 724: 513000, 28: 513000, 266: 154600, 270: 154600,
                    244: 513000, 506: 513000, 594: 513000, 587: 513000, 502: 154600, 600: 513000, 578: 513000,
                    713: 513000, 760: 513000, 716: 513000, 662: 154600, 663: 154600, 665: 513000, 667: 154600,
                    690: 513000, 691: 513000, 756: 154600, 711: 154600, 712: 154600, 768: 513000, 546: 154600,
                    631: 513000, 543: 513000, 632: 513000, 12: 513000, 376: 513000, 383: 513000, 342: 154600,
                    478: 154600, 164: 723334, 348: 723334, 559: 723334, 262: 513000, 221: 513000, 174: 513000,
                    133: 723334, 524: 513000, 785: 513000, 786: 154600, 787: 154600, 788: 154600, 789: 154600,
                    790: 513000, 791: 513000, 792: 513000, 793: 154600, 794: 513000, 795: 513000, 746: 154600,
                    779: 154600, 780: 513000, 781: 513000, 738: 513000, 736: 154600, 766: 513000, 769: 513000,
                    773: 513000, 774: 513000, 775: 513000, 776: 513000, 676: 513000, 681: 513000, 682: 513000,
                    651: 513000, 684: 513000, 705: 513000, 654: 513000, 90: 513000, 220: 513000, 119: 513000,
                    68: 513000, 101: 513000, 34: 513000, 192: 513000, 393: 513000, 310: 154600, 11: 513000, 159: 513000,
                    604: 513000, 206: 513000, 253: 154600, 660: 513000, 652: 154600, 633: 513000, 343: 154600,
                    242: 513000, 486: 513000, 540: 513000, 609: 154600, 635: 513000, 487: 513000, 496: 513000,
                    623: 513000, 639: 513000, 747: 513000, 618: 154600, 619: 513000, 620: 513000, 127: 723334,
                    508: 513000, 641: 513000, 570: 513000, 722: 513000, 354: 723334, 707: 513000, 708: 154600,
                    709: 154600, 710: 513000, 675: 513000, 734: 513000, 24: 513000, 649: 513000, 650: 513000,
                    645: 154600, 646: 154600, 647: 154600, 804: 723334, 805: 723334, 803: 723334, 653: 513000,
                    661: 513000, 806: 513000, 807: 513000, 808: 513000, 809: 513000, 810: 513000, 811: 513000,
                    489: 723334, 900: 513000, 849: 513000, 855: 513000, 856: 513000, 846: 513000, 847: 513000,
                    858: 513000, 876: 513000, 864: 513000, 841: 513000, 888: 513000, 882: 513000, 897: 513000,
                    885: 513000, 886: 513000, 867: 513000, 852: 513000, 822: 723334, 823: 723334, 824: 723334,
                    859: 513000, 714: 154600, 715: 513000, 840: 513000, 891: 513000, 892: 513000, 813: 513000,
                    814: 513000, 815: 513000, 861: 513000, 894: 513000, 837: 513000, 843: 513000, 879: 513000,
                    819: 513000, 820: 513000, 877: 513000, 834: 513000, 835: 513000, 831: 513000, 832: 513000,
                    833: 513000, 898: 513000, 873: 513000, 850: 513000, 621: 513000, 439: 513000, 434: 513000,
                    862: 513000, 863: 513000, 723: 513000, 725: 513000, 657: 513000, 658: 513000, 744: 154600,
                    745: 154600, 741: 513000, 742: 154600, 889: 513000, 798: 513000, 364: 154600, 617: 513000,
                    750: 154600, 870: 513000, 696: 513000, 361: 154600, 146: 154600, 386: 154600, 504: 154600,
                    430: 154600, 272: 154600, 33: 154600, 88: 154600, 533: 154600, 222: 154600, 409: 154600,
                    678: 154600, 755: 154600, 92: 154600, 216: 154600, 517: 154600, 673: 154600, 783: 154600,
                    757: 154600, 758: 154600, 664: 154600, 291: 154600, 694: 154600, 152: 154600, 189: 154600,
                    692: 154600, 286: 154600, 260: 154600, 294: 154600, 556: 154600, 389: 154600, 161: 154600,
                    375: 154600, 340: 154600, 323: 154600, 203: 154600, 516: 154600, 531: 154600, 493: 154600,
                    717: 154600, 442: 154600, 167: 154600, 325: 154600, 195: 154600, 544: 154600, 176: 154600,
                    309: 154600, 311: 154600, 259: 154600, 15: 154600, 470: 154600, 238: 154600, 267: 154600,
                    728: 154600, 355: 154600, 144: 154600, 390: 154600, 484: 154600, 483: 154600, 378: 154600,
                    379: 154600, 380: 154600, 547: 154600, 548: 154600, 501: 154600, 345: 154600, 346: 154600,
                    347: 154600, 330: 154600, 331: 154600, 332: 154600, 228: 154600, 229: 154600, 497: 154600,
                    498: 154600, 761: 154600, 763: 154600, 59: 154600, 61: 154600, 200: 154600, 201: 154600, 17: 154600,
                    465: 154600, 466: 154600, 76: 154600, 78: 154600, 36: 154600, 141: 154600, 143: 154600, 569: 154600,
                    567: 154600, 448: 154600, 106: 154600, 234: 154600, 235: 154600, 236: 154600, 303: 154600,
                    304: 154600, 344: 154600, 84: 154600, 579: 154600, 580: 154600, 581: 154600, 456: 1350, 457: 1350, 329: 41134}

# print(pci_to_freq_dict)

if __name__ == '__main__':
    # 读取csv文件
    csv_file = r'D:\MrData\3月4号\下午\小米13-5G--IN20240304-143418-Ping(1)异系统数据.csv'
    res_df = pd.read_csv(csv_file)

    empty_key_list = []

    # PCI对应频点
    res_df['freq'] = res_df[
        r'NR->MeasurementReport\UL-DCCH-Message\message\c1\measurementReport\criticalExtensions\measurementReport\measResults\measResultNeighCells\measResultListEUTRA\MeasResultEUTRA\eutra-PhysCellId'].apply(
        lambda key: pci_to_freq_dict.get(key) if key in pci_to_freq_dict.keys() else empty_key_list.append(key))

    # print_with_line_number(res_df['freq'], __file__)

    df_write_to_csv(res_df, r'D:\MrData\3月4号\demo异系统数据_1.csv')

    empty_key_list = list(set(empty_key_list))

    print_with_line_number(f'未找到freq的pci值列表: 期望值：[] 实际值：{empty_key_list}', __file__)
